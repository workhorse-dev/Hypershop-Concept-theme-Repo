<script>
  // Ensure lcw is globally available
  window.lcw = function() {
    return {
      styleProps: {
        generalStyles: {
          width: "360px",
          height: "560px",
          bottom: "10px",
          right: "20px",
          top: "unset",
          left: "unset"
        }
      },
      chatButtonProps: {
        controlProps: {
          hideChatTextContainer: true
        },
        styleProps: {
          generalStyleProps: {
            minWidth: "60px",
            width: "60px",
            height: "60px"
          },
          iconStyleProps: {
            backgroundColor: "#334fb4"
          }
        }
      },
      headerProps: {
        styleProps: {
          generalStyleProps: {
            backgroundColor: "#334fb4"
          },
          iconStyleProps: {
            width: "50px",
            height: "50px",
            color: "white"
          },
          titleStyleProps: {
            color: "white",
            fontWeight: 600
          },
          closeButtonStyleProps: {
            margin: "10px 5px 5px 5px",
            color: "white"
          },
          closeButtonHoverStyleProps: {
            backgroundColor: "rgba(200, 200, 200, 0.2)",
            margin: "10px 5px 5px 5px",
            color: "white"
          },
          minimizeButtonStyleProps: {
            margin: "10px 5px 5px 5px",
            color: "white"
          },
          minimizeButtonHoverStyleProps: {
            backgroundColor: "rgba(200, 200, 200, 0.2)",
            margin: "10px 5px 5px 5px",
            color: "white"
          }
        }
      },
      preChatSurveyPaneProps: {
        styleProps: {
          customButtonStyleProps: {
            backgroundColor: "#334fb4"
          }
        }
      }
    };
  };
</script>

<script>
  window.addEventListener('load', () => {
    setTimeout(() => {
      const lcwScript = document.createElement('script');
      lcwScript.id = "Microsoft_Omnichannel_LCWidget";
      lcwScript.src = "https://oc-cdn-ocprod.azureedge.net/livechatwidget/scripts/LiveChatBootstrapper.js";

      // These MUST be set as attributes for the widget to work
      lcwScript.setAttribute("v2", "true");
      lcwScript.setAttribute("data-app-id", "65e7e3fd-a294-4360-ba33-7398672f2ca9");
      lcwScript.setAttribute("data-lcw-version", "prod");
      lcwScript.setAttribute("data-org-id", "f2015019-2dea-4f2f-9c31-487a8cc6d38f");
      lcwScript.setAttribute("data-org-url", "https://m-f2015019-2dea-4f2f-9c31-487a8cc6d38f.us.omnichannelengagementhub.com");
      lcwScript.setAttribute("data-customization-callback", "lcw");

      document.body.appendChild(lcwScript);
    }, 5000); // Delay 3s after load
  });
</script>
<script>
  const chatWidget = document.querySelector('#Microsoft_Omnichannel_LCWidget_Chat_Iframe_Window');
  const width = screen.width;
  {% comment %} if (chatWidget &&  width > 470) {
      chatWidget.style.transform = 'translateY(calc(50% + 100px))';
    } {% endcomment %}
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const chatObserver = setInterval(() => {
      const chatBtn = document.querySelector("#oc-lcw-chat-button"); // your chat button
      const footer = document.querySelector(".footer-group");

      if (chatBtn && footer) {
        chatBtn.classList.add("custom-chat-button");

        function adjustChatButton() {
          const footerRect = footer.getBoundingClientRect();
          const windowHeight = window.innerHeight;

          // If footer is visible in viewport â†’ push chat button up
          if (footerRect.top < windowHeight) {
            chatBtn.style.bottom = "120px";
          } else {
            chatBtn.style.bottom = "10px";
          }
        }

        // Run on scroll + resize
        window.addEventListener("scroll", adjustChatButton);
        window.addEventListener("resize", adjustChatButton);

        adjustChatButton(); // Run once at load
        clearInterval(chatObserver); // stop checking
      }
    }, 500);
  });
</script>
